"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getPrebuildConfigAsync = getPrebuildConfigAsync;
<<<<<<< HEAD
=======

>>>>>>> 279c076d3cb6520341221d8adc510e9dbdcbb7c2
function _config() {
  const data = require("@expo/config");
  _config = function () {
    return data;
  };
  return data;
}
<<<<<<< HEAD
function _getAutolinkedPackages() {
  const data = require("./getAutolinkedPackages");
  _getAutolinkedPackages = function () {
    return data;
  };
  return data;
}
=======

function _getAutolinkedPackages() {
  const data = require("./getAutolinkedPackages");

  _getAutolinkedPackages = function () {
    return data;
  };

  return data;
}

>>>>>>> 279c076d3cb6520341221d8adc510e9dbdcbb7c2
function _withDefaultPlugins() {
  const data = require("./plugins/withDefaultPlugins");
  _withDefaultPlugins = function () {
    return data;
  };
  return data;
}
<<<<<<< HEAD
async function getPrebuildConfigAsync(projectRoot, props) {
  const autolinkedModules = await (0, _getAutolinkedPackages().getAutolinkedPackagesAsync)(projectRoot, props.platforms);
  return getPrebuildConfig(projectRoot, {
    ...props,
    autolinkedModules
  });
}
=======

async function getPrebuildConfigAsync(projectRoot, props) {
  const autolinkedModules = await (0, _getAutolinkedPackages().getAutolinkedPackagesAsync)(projectRoot, props.platforms);
  return getPrebuildConfig(projectRoot, { ...props,
    autolinkedModules
  });
}

>>>>>>> 279c076d3cb6520341221d8adc510e9dbdcbb7c2
function getPrebuildConfig(projectRoot, {
  platforms,
  bundleIdentifier,
  packageName,
<<<<<<< HEAD
  autolinkedModules
=======
  autolinkedModules,
  expoUsername
>>>>>>> 279c076d3cb6520341221d8adc510e9dbdcbb7c2
}) {
  // let config: ExpoConfig;
  let {
    exp: config,
    ...rest
  } = (0, _config().getConfig)(projectRoot, {
    skipSDKVersionRequirement: true,
    isModdedConfig: true
  });
<<<<<<< HEAD
=======

>>>>>>> 279c076d3cb6520341221d8adc510e9dbdcbb7c2
  if (autolinkedModules) {
    if (!config._internal) {
      config._internal = {};
    }
<<<<<<< HEAD
    config._internal.autolinkedModules = autolinkedModules;
  }

  // Add all built-in plugins first because they should take
=======

    config._internal.autolinkedModules = autolinkedModules;
  }

  const resolvedExpoUsername = typeof expoUsername === 'function' ? expoUsername(config) : // If the user didn't pass a username then fallback on the static cached username.
  expoUsername !== null && expoUsername !== void 0 ? expoUsername : (0, _config().getAccountUsername)(config); // Add all built-in plugins first because they should take
>>>>>>> 279c076d3cb6520341221d8adc510e9dbdcbb7c2
  // priority over the unversioned plugins.
  config = (0, _withDefaultPlugins().withVersionedExpoSDKPlugins)(config);
  config = (0, _withDefaultPlugins().withLegacyExpoPlugins)(config);
  if (platforms.includes('ios')) {
    if (!config.ios) config.ios = {};
    config.ios.bundleIdentifier = bundleIdentifier ?? config.ios.bundleIdentifier ?? `com.placeholder.appid`;

    // Add all built-in plugins
    config = (0, _withDefaultPlugins().withIosExpoPlugins)(config, {
      bundleIdentifier: config.ios.bundleIdentifier
    });
  }
  if (platforms.includes('android')) {
    if (!config.android) config.android = {};
    config.android.package = packageName ?? config.android.package ?? `com.placeholder.appid`;

    // Add all built-in plugins
    config = (0, _withDefaultPlugins().withAndroidExpoPlugins)(config, {
      package: config.android.package
    });
  }
  return {
    exp: config,
    ...rest
  };
}
//# sourceMappingURL=getPrebuildConfig.js.map