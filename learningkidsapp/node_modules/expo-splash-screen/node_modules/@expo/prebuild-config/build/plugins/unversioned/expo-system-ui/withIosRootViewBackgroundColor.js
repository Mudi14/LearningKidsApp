"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getRootViewBackgroundColor = getRootViewBackgroundColor;
exports.setRootViewBackgroundColor = setRootViewBackgroundColor;
exports.shouldUseLegacyBehavior = shouldUseLegacyBehavior;
exports.warnSystemUIMissing = warnSystemUIMissing;
exports.withIosRootViewBackgroundColor = void 0;
<<<<<<< HEAD
function _configPlugins() {
  const data = require("@expo/config-plugins");
  _configPlugins = function () {
    return data;
  };
  return data;
}
function _normalizeColors() {
  const data = _interopRequireDefault(require("@react-native/normalize-colors"));
  _normalizeColors = function () {
    return data;
  };
  return data;
}
function _semver() {
  const data = _interopRequireDefault(require("semver"));
  _semver = function () {
    return data;
  };
  return data;
}
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
// @ts-ignore: uses flow

// Maps to the template AppDelegate.m
const BACKGROUND_COLOR_KEY = 'RCTRootViewBackgroundColor';
const debug = require('debug')('expo:system-ui:plugin:ios');
=======

function _configPlugins() {
  const data = require("@expo/config-plugins");

  _configPlugins = function () {
    return data;
  };

  return data;
}

function _normalizeColor() {
  const data = _interopRequireDefault(require("@react-native/normalize-color"));

  _normalizeColor = function () {
    return data;
  };

  return data;
}

function _semver() {
  const data = _interopRequireDefault(require("semver"));

  _semver = function () {
    return data;
  };

  return data;
}

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// @ts-ignore: uses flow
// Maps to the template AppDelegate.m
const BACKGROUND_COLOR_KEY = 'RCTRootViewBackgroundColor';

const debug = require('debug')('expo:system-ui:plugin:ios');

>>>>>>> 279c076d3cb6520341221d8adc510e9dbdcbb7c2
const withIosRootViewBackgroundColor = config => {
  config = (0, _configPlugins().withInfoPlist)(config, config => {
    if (shouldUseLegacyBehavior(config)) {
      config.modResults = setRootViewBackgroundColor(config, config.modResults);
    } else {
      warnSystemUIMissing(config);
    }
<<<<<<< HEAD
=======

>>>>>>> 279c076d3cb6520341221d8adc510e9dbdcbb7c2
    return config;
  });
  return config;
};
<<<<<<< HEAD

/** The template was changed in SDK 43 to move the background color logic to the `expo-system-ui` module */
exports.withIosRootViewBackgroundColor = withIosRootViewBackgroundColor;
=======
/** The template was changed in SDK 43 to move the background color logic to the `expo-system-ui` module */


exports.withIosRootViewBackgroundColor = withIosRootViewBackgroundColor;

>>>>>>> 279c076d3cb6520341221d8adc510e9dbdcbb7c2
function shouldUseLegacyBehavior(config) {
  try {
    return !!(config.sdkVersion && _semver().default.lt(config.sdkVersion, '44.0.0'));
  } catch {}
<<<<<<< HEAD
  return false;
}
function warnSystemUIMissing(config) {
  const backgroundColor = getRootViewBackgroundColor(config);
=======

  return false;
}

function warnSystemUIMissing(config) {
  const backgroundColor = getRootViewBackgroundColor(config);

>>>>>>> 279c076d3cb6520341221d8adc510e9dbdcbb7c2
  if (backgroundColor) {
    // Background color needs to be set programmatically
    _configPlugins().WarningAggregator.addWarningIOS('ios.backgroundColor', 'Install expo-system-ui to enable this feature', 'https://docs.expo.dev/build-reference/migrating/#expo-config--backgroundcolor--depends-on');
  }
}
<<<<<<< HEAD
function setRootViewBackgroundColor(config, infoPlist) {
  const backgroundColor = getRootViewBackgroundColor(config);
  if (!backgroundColor) {
    delete infoPlist[BACKGROUND_COLOR_KEY];
  } else {
    let color = (0, _normalizeColors().default)(backgroundColor);
    if (!color) {
      throw new Error('Invalid background color on iOS');
    }
=======

function setRootViewBackgroundColor(config, infoPlist) {
  const backgroundColor = getRootViewBackgroundColor(config);

  if (!backgroundColor) {
    delete infoPlist[BACKGROUND_COLOR_KEY];
  } else {
    let color = (0, _normalizeColor().default)(backgroundColor);

    if (!color) {
      throw new Error('Invalid background color on iOS');
    }

>>>>>>> 279c076d3cb6520341221d8adc510e9dbdcbb7c2
    color = (color << 24 | color >>> 8) >>> 0;
    infoPlist[BACKGROUND_COLOR_KEY] = color;
    debug(`Convert color: ${backgroundColor} -> ${color}`);
  }
<<<<<<< HEAD
  return infoPlist;
}
function getRootViewBackgroundColor(config) {
  return config.ios?.backgroundColor || config.backgroundColor || null;
=======

  return infoPlist;
}

function getRootViewBackgroundColor(config) {
  var _config$ios;

  return ((_config$ios = config.ios) === null || _config$ios === void 0 ? void 0 : _config$ios.backgroundColor) || config.backgroundColor || null;
>>>>>>> 279c076d3cb6520341221d8adc510e9dbdcbb7c2
}
//# sourceMappingURL=withIosRootViewBackgroundColor.js.map